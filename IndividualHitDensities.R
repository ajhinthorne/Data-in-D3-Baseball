#Densities for Each Hit Type
library(dplyr)
library(ggplot2)
#Types of Hits
positions <- c("to left field", "up the middle", "through the left side", "to right field", "through the right side", "to left center", "to right center", "down the left field line", "down the right field line", "to third base", "to short stop", "to second base", "to first base", "to center field", "down the lf line", "down the rf line")
hitscatter<-spraycharts%>%filter(type=="H")%>%filter(Description!="Home Run")%>%filter(y>=25)%>%ggplot(aes(x=x,y=-y+250,color=Description,ymin=25,ymax=245))+geom_jitter()
hitscatter

hitscatter2<-hitscatter+geom_point(aes(x=125,y=35),color="black")+geom_abline(slope=-1,intercept=160)+geom_abline(slope=1,intercept=-90)
hitscatter3<-hitscatter2+geom_abline(slope=-1.25,intercept=191.25)+geom_abline(slope=1.25,intercept=-121.25)
hitscatter4<-hitscatter3+geom_abline(slope=-2.25,intercept=316.25)+geom_abline(slope=2.25,intercept=-246.25)+geom_abline(slope=-5.5,intercept=722.5)+geom_abline(slope=5.5,intercept=-652.5)
hitscatter4+geom_point(aes(x=125,y=200),color="black")+geom_point(aes(x=125,y=135),color="black")
hitscatter5<-hitscatter4+geom_abline(slope=-.5,intercept=207.5)+geom_abline(slope=.5,intercept=82.5)
hitscatter5


spraycharts2<-spraycharts%>%dplyr::select("Description","x","y","type")%>%mutate(z=-y+250)
View(spraycharts2)

single.lf<-spraycharts2%>%filter(Description=="Single")%>%filter(z<=235)%>%filter(x>=5)%>%filter(z>=(-1.25*x)+191.25)%>%filter(z<=(-2.25*x)+316.25)%>%filter(z>=(.5*x)+82.5)
single.rf<-spraycharts2%>%filter(Description=="Single")%>%filter(z<=235)%>%filter(z>=(1.25*x)-121.25)%>%filter(z<=(2.25*x)-246.25)%>%filter(z>=(-.5*x)+207.5)
single.cf<-spraycharts2%>%filter(Description=="Single")%>%filter(z<=235)%>%filter(z>=(5.5*x)-652.5)%>%filter(z>=(-5.5*x)+722.5)%>%filter(z>=(-.5*x)+207.5)%>%filter(z>=(.5*x)+82.5)
single.triangle1<-spraycharts2%>%filter(Description=="Single")%>%filter(z>=(5.5*x)-652.5)%>%filter(z>=(-5.5*x)+722.5)%>%filter(z>=(-.5*x)+207.5)%>%filter(z<=(.5*x)+82.5)
single.triangle2<-spraycharts2%>%filter(Description=="Single")%>%filter(z>=(5.5*x)-652.5)%>%filter(z>=(-5.5*x)+722.5)%>%filter(z<=(-.5*x)+207.5)%>%filter(z>=(.5*x)+82.5)
single.cf2<-bind_rows(single.cf,single.triangle1,single.triangle2)
single.utm<-spraycharts2%>%filter(Description=="Single")%>%filter(z<=235)%>%filter(z>=(5.5*x)-652.5)%>%filter(z>=(-5.5*x)+722.5)%>%filter(z<=(-.5*x)+207.5)%>%filter(z<=(.5*x)+82.5)
single.lcf<-spraycharts2%>%filter(Description=="Single")%>%filter(z<=235)%>%filter(z<=(-5.5*x)+722.5)%>%filter(z>=(-2.25*x)+316.25)%>%filter(z>=(.5*x)+82.5)
single.rcf<-spraycharts2%>%filter(Description=="Single")%>%filter(z<=235)%>%filter(z>=(2.25*x)-246.25)%>%filter(z>=(-.5*x)+207.5)%>%filter(z<=(5.5*x)-652.5)
single.lfl<-spraycharts2%>%filter(Description=="Single")%>%filter(z>=25)%>%filter(x>=5)%>%filter(z<=(-1.25*x)+191.25)
single.rfl<-spraycharts2%>%filter(Description=="Single")%>%filter(z>=25)%>%filter(x>=5)%>%filter(z<=(1.25*x)-121.25)
single.ss<-spraycharts2%>%filter(Description=="Single")%>%filter(z<=235)%>%filter(z<=(-5.5*x)+722.5)%>%filter(z>=(-2.25*x)+316.25)%>%filter(z<=(.5*x)+82.5)
single.2b<-spraycharts2%>%filter(Description=="Single")%>%filter(z<=235)%>%filter(z>=(2.25*x)-246.25)%>%filter(z<=(-.5*x)+207.5)%>%filter(z<=(5.5*x)-652.5)
single.3b<-spraycharts2%>%filter(Description=="Single")%>%filter(z<=235)%>%filter(x>=5)%>%filter(z>=(-1.25*x)+191.25)%>%filter(z<=(-2.25*x)+316.25)%>%filter(z<=(.5*x)+82.5)
single.1b<-spraycharts2%>%filter(Description=="Single")%>%filter(z<=235)%>%filter(z>=(1.25*x)-121.25)%>%filter(z<=(2.25*x)-246.25)%>%filter(z<=(-.5*x)+207.5)
single.tls<-bind_rows(single.3b,single.ss)
single.trs<-bind_rows(single.2b,single.1b)

double.lf<-spraycharts2%>%filter(Description=="Double")%>%filter(z<=235)%>%filter(x>=5)%>%filter(z>=(-1.25*x)+191.25)%>%filter(z<=(-2.25*x)+316.25)%>%filter(z>=(.5*x)+82.5)
double.rf<-spraycharts2%>%filter(Description=="Double")%>%filter(z<=235)%>%filter(z>=(1.25*x)-121.25)%>%filter(z<=(2.25*x)-246.25)%>%filter(z>=(-.5*x)+207.5)
double.cf<-spraycharts2%>%filter(Description=="Double")%>%filter(z<=235)%>%filter(z>=(5.5*x)-652.5)%>%filter(z>=(-5.5*x)+722.5)%>%filter(z>=(-.5*x)+207.5)%>%filter(z>=(.5*x)+82.5)
double.triangle1<-spraycharts2%>%filter(Description=="Double")%>%filter(z>=(5.5*x)-652.5)%>%filter(z>=(-5.5*x)+722.5)%>%filter(z>=(-.5*x)+207.5)%>%filter(z<=(.5*x)+82.5)
double.triangle2<-spraycharts2%>%filter(Description=="Double")%>%filter(z>=(5.5*x)-652.5)%>%filter(z>=(-5.5*x)+722.5)%>%filter(z<=(-.5*x)+207.5)%>%filter(z>=(.5*x)+82.5)
double.cf2<-bind_rows(double.cf,double.triangle1,double.triangle2)
double.utm<-spraycharts2%>%filter(Description=="Double")%>%filter(z<=235)%>%filter(z>=(5.5*x)-652.5)%>%filter(z>=(-5.5*x)+722.5)%>%filter(z<=(-.5*x)+207.5)%>%filter(z<=(.5*x)+82.5)
double.lcf<-spraycharts2%>%filter(Description=="Double")%>%filter(z<=235)%>%filter(z<=(-5.5*x)+722.5)%>%filter(z>=(-2.25*x)+316.25)%>%filter(z>=(.5*x)+82.5)
double.rcf<-spraycharts2%>%filter(Description=="Double")%>%filter(z<=235)%>%filter(z>=(2.25*x)-246.25)%>%filter(z>=(-.5*x)+207.5)%>%filter(z<=(5.5*x)-652.5)
double.lfl<-spraycharts2%>%filter(Description=="Double")%>%filter(z>=25)%>%filter(x>=5)%>%filter(z<=(-1.25*x)+191.25)
double.rfl<-spraycharts2%>%filter(Description=="Double")%>%filter(z>=25)%>%filter(x>=5)%>%filter(z<=(1.25*x)-121.25)
double.ss<-spraycharts2%>%filter(Description=="Double")%>%filter(z<=235)%>%filter(z<=(-5.5*x)+722.5)%>%filter(z>=(-2.25*x)+316.25)%>%filter(z<=(.5*x)+82.5)
double.2b<-spraycharts2%>%filter(Description=="Double")%>%filter(z<=235)%>%filter(z>=(2.25*x)-246.25)%>%filter(z<=(-.5*x)+207.5)%>%filter(z<=(5.5*x)-652.5)
double.3b<-spraycharts2%>%filter(Description=="Double")%>%filter(z<=235)%>%filter(x>=5)%>%filter(z>=(-1.25*x)+191.25)%>%filter(z<=(-2.25*x)+316.25)%>%filter(z<=(.5*x)+82.5)
double.1b<-spraycharts2%>%filter(Description=="Double")%>%filter(z<=235)%>%filter(z>=(1.25*x)-121.25)%>%filter(z<=(2.25*x)-246.25)%>%filter(z<=(-.5*x)+207.5)
double.tls<-bind_rows(double.3b,double.ss)
double.trs<-bind_rows(double.2b,double.1b)

triple.lf<-spraycharts2%>%filter(Description=="Triple")%>%filter(z<=235)%>%filter(x>=5)%>%filter(z>=(-1.25*x)+191.25)%>%filter(z<=(-2.25*x)+316.25)%>%filter(z>=(.5*x)+82.5)
triple.rf<-spraycharts2%>%filter(Description=="Triple")%>%filter(z<=235)%>%filter(z>=(1.25*x)-121.25)%>%filter(z<=(2.25*x)-246.25)%>%filter(z>=(-.5*x)+207.5)
triple.cf<-spraycharts2%>%filter(Description=="Triple")%>%filter(z<=235)%>%filter(z>=(5.5*x)-652.5)%>%filter(z>=(-5.5*x)+722.5)%>%filter(z>=(-.5*x)+207.5)%>%filter(z>=(.5*x)+82.5)
triple.triangle1<-spraycharts2%>%filter(Description=="Triple")%>%filter(z>=(5.5*x)-652.5)%>%filter(z>=(-5.5*x)+722.5)%>%filter(z>=(-.5*x)+207.5)%>%filter(z<=(.5*x)+82.5)
triple.triangle2<-spraycharts2%>%filter(Description=="Triple")%>%filter(z>=(5.5*x)-652.5)%>%filter(z>=(-5.5*x)+722.5)%>%filter(z<=(-.5*x)+207.5)%>%filter(z>=(.5*x)+82.5)
triple.cf2<-bind_rows(triple.cf,triple.triangle1,triple.triangle2)
triple.utm<-spraycharts2%>%filter(Description=="Triple")%>%filter(z<=235)%>%filter(z>=(5.5*x)-652.5)%>%filter(z>=(-5.5*x)+722.5)%>%filter(z<=(-.5*x)+207.5)%>%filter(z<=(.5*x)+82.5)
triple.lcf<-spraycharts2%>%filter(Description=="Triple")%>%filter(z<=235)%>%filter(z<=(-5.5*x)+722.5)%>%filter(z>=(-2.25*x)+316.25)%>%filter(z>=(.5*x)+82.5)
triple.rcf<-spraycharts2%>%filter(Description=="Triple")%>%filter(z<=235)%>%filter(z>=(2.25*x)-246.25)%>%filter(z>=(-.5*x)+207.5)%>%filter(z<=(5.5*x)-652.5)
triple.lfl<-spraycharts2%>%filter(Description=="Triple")%>%filter(z>=25)%>%filter(x>=5)%>%filter(z<=(-1.25*x)+191.25)
triple.rfl<-spraycharts2%>%filter(Description=="Triple")%>%filter(z>=25)%>%filter(x>=5)%>%filter(z<=(1.25*x)-121.25)
triple.ss<-spraycharts2%>%filter(Description=="Triple")%>%filter(z<=235)%>%filter(z<=(-5.5*x)+722.5)%>%filter(z>=(-2.25*x)+316.25)%>%filter(z<=(.5*x)+82.5)
triple.2b<-spraycharts2%>%filter(Description=="Triple")%>%filter(z<=235)%>%filter(z>=(2.25*x)-246.25)%>%filter(z<=(-.5*x)+207.5)%>%filter(z<=(5.5*x)-652.5)
triple.3b<-spraycharts2%>%filter(Description=="Triple")%>%filter(z<=235)%>%filter(x>=5)%>%filter(z>=(-1.25*x)+191.25)%>%filter(z<=(-2.25*x)+316.25)%>%filter(z<=(.5*x)+82.5)
triple.1b<-spraycharts2%>%filter(Description=="Triple")%>%filter(z<=235)%>%filter(z>=(1.25*x)-121.25)%>%filter(z<=(2.25*x)-246.25)%>%filter(z<=(-.5*x)+207.5)
triple.tls<-bind_rows(triple.3b,triple.ss)
triple.trs<-bind_rows(triple.2b,triple.1b)

#Now the Densities
library(MASS)
single.lf.den<-single.lf%>%ggplot(aes(x=x,y=z,xmin=0,xmax=250,ymin=0,ymax=250))+geom_density2d()
single.rf.den<-single.rf%>%ggplot(aes(x=x,y=z,xmin=0,xmax=250,ymin=0,ymax=250))+geom_density2d()
single.cf2.den<-single.cf2%>%ggplot(aes(x=x,y=z,xmin=0,xmax=250,ymin=0,ymax=250))+geom_density2d()
single.utm.den<-single.utm%>%ggplot(aes(x=x,y=z,xmin=0,xmax=250,ymin=0,ymax=250))+geom_density2d()
single.lcf.den<-single.lcf%>%ggplot(aes(x=x,y=z,xmin=0,xmax=250,ymin=0,ymax=250))+geom_density2d()
single.rcf.den<-single.rcf%>%ggplot(aes(x=x,y=z,xmin=0,xmax=250,ymin=0,ymax=250))+geom_density2d()
single.lfl.den<-single.lfl%>%ggplot(aes(x=x,y=z,xmin=0,xmax=250,ymin=0,ymax=250))+geom_density2d()
single.rfl.den<-single.rfl%>%ggplot(aes(x=x,y=z,xmin=0,xmax=250,ymin=0,ymax=250))+geom_density2d()
single.ss.den<-single.ss%>%ggplot(aes(x=x,y=z,xmin=0,xmax=250,ymin=0,ymax=250))+geom_density2d()
single.2b.den<-single.2b%>%ggplot(aes(x=x,y=z,xmin=0,xmax=250,ymin=0,ymax=250))+geom_density2d()
single.3b.den<-single.3b%>%ggplot(aes(x=x,y=z,xmin=0,xmax=250,ymin=0,ymax=250))+geom_density2d()
single.1b.den<-single.1b%>%ggplot(aes(x=x,y=z,xmin=0,xmax=250,ymin=0,ymax=250))+geom_density2d()
single.tls.den<-single.tls%>%ggplot(aes(x=x,y=z,xmin=0,xmax=250,ymin=0,ymax=250))+geom_density2d()
single.trs.den<-single.trs%>%ggplot(aes(x=x,y=z,xmin=0,xmax=250,ymin=0,ymax=250))+geom_density2d()

double.lf.den<-double.lf%>%ggplot(aes(x=x,y=z,xmin=0,xmax=250,ymin=0,ymax=250))+geom_density2d()
double.rf.den<-double.rf%>%ggplot(aes(x=x,y=z,xmin=0,xmax=250,ymin=0,ymax=250))+geom_density2d()
double.cf2.den<-double.cf2%>%ggplot(aes(x=x,y=z,xmin=0,xmax=250,ymin=0,ymax=250))+geom_density2d()
double.utm.den<-double.utm%>%ggplot(aes(x=x,y=z,xmin=0,xmax=250,ymin=0,ymax=250))+geom_density2d()
double.lcf.den<-double.lcf%>%ggplot(aes(x=x,y=z,xmin=0,xmax=250,ymin=0,ymax=250))+geom_density2d()
double.rcf.den<-double.rcf%>%ggplot(aes(x=x,y=z,xmin=0,xmax=250,ymin=0,ymax=250))+geom_density2d()
double.lfl.den<-double.lfl%>%ggplot(aes(x=x,y=z,xmin=0,xmax=250,ymin=0,ymax=250))+geom_density2d()
double.rfl.den<-double.rfl%>%ggplot(aes(x=x,y=z,xmin=0,xmax=250,ymin=0,ymax=250))+geom_density2d()
double.ss.den<-double.ss%>%ggplot(aes(x=x,y=z,xmin=0,xmax=250,ymin=0,ymax=250))+geom_density2d()
double.2b.den<-double.2b%>%ggplot(aes(x=x,y=z,xmin=0,xmax=250,ymin=0,ymax=250))+geom_density2d()
double.3b.den<-double.3b%>%ggplot(aes(x=x,y=z,xmin=0,xmax=250,ymin=0,ymax=250))+geom_density2d()
double.1b.den<-double.1b%>%ggplot(aes(x=x,y=z,xmin=0,xmax=250,ymin=0,ymax=250))+geom_density2d()
double.tls.den<-double.tls%>%ggplot(aes(x=x,y=z,xmin=0,xmax=250,ymin=0,ymax=250))+geom_density2d()
double.trs.den<-double.trs%>%ggplot(aes(x=x,y=z,xmin=0,xmax=250,ymin=0,ymax=250))+geom_density2d()

triple.lf.den<-triple.lf%>%ggplot(aes(x=x,y=z,xmin=0,xmax=250,ymin=0,ymax=250))+geom_density2d()
triple.rf.den<-triple.rf%>%ggplot(aes(x=x,y=z,xmin=0,xmax=250,ymin=0,ymax=250))+geom_density2d()
triple.cf2.den<-triple.cf2%>%ggplot(aes(x=x,y=z,xmin=0,xmax=250,ymin=0,ymax=250))+geom_density2d()
triple.utm.den<-triple.utm%>%ggplot(aes(x=x,y=z,xmin=0,xmax=250,ymin=0,ymax=250))+geom_density2d()
triple.lcf.den<-triple.lcf%>%ggplot(aes(x=x,y=z,xmin=0,xmax=250,ymin=0,ymax=250))+geom_density2d()
triple.rcf.den<-triple.rcf%>%ggplot(aes(x=x,y=z,xmin=0,xmax=250,ymin=0,ymax=250))+geom_density2d()
triple.lfl.den<-triple.lfl%>%ggplot(aes(x=x,y=z,xmin=0,xmax=250,ymin=0,ymax=250))+geom_density2d()
triple.rfl.den<-triple.rfl%>%ggplot(aes(x=x,y=z,xmin=0,xmax=250,ymin=0,ymax=250))+geom_density2d()
triple.ss.den<-triple.ss%>%ggplot(aes(x=x,y=z,xmin=0,xmax=250,ymin=0,ymax=250))+geom_density2d()
triple.2b.den<-triple.2b%>%ggplot(aes(x=x,y=z,xmin=0,xmax=250,ymin=0,ymax=250))+geom_density2d()
triple.3b.den<-triple.3b%>%ggplot(aes(x=x,y=z,xmin=0,xmax=250,ymin=0,ymax=250))+geom_density2d()
triple.1b.den<-triple.1b%>%ggplot(aes(x=x,y=z,xmin=0,xmax=250,ymin=0,ymax=250))+geom_density2d()
triple.tls.den<-triple.tls%>%ggplot(aes(x=x,y=z,xmin=0,xmax=250,ymin=0,ymax=250))+geom_density2d()
triple.trs.den<-triple.trs%>%ggplot(aes(x=x,y=z,xmin=0,xmax=250,ymin=0,ymax=250))+geom_density2d()


ggplot(aes(x=x,y=z,xmin=0,xmax=250,ymin=0,ymax=250))+geom_density2d()


